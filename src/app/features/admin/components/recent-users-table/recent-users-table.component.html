<div class="users-table-container">
  <table mat-table [dataSource]="users()" class="users-table">
    <!-- Avatar + Name Column -->
    <ng-container matColumnDef="user">
      <th mat-header-cell *matHeaderCellDef>User</th>
      <td mat-cell *matCellDef="let user">
        <div class="user-cell">
          <div class="user-avatar" [class]="user.role.toLowerCase()">
            {{ user.name.charAt(0) }}
          </div>
          <div class="user-info">
            <span class="user-name">{{ user.name }}</span>
            <span class="user-contact">{{ user.phone }}</span>
          </div>
        </div>
      </td>
    </ng-container>

    <!-- Role Column -->
    <ng-container matColumnDef="role">
      <th mat-header-cell *matHeaderCellDef>Role</th>
      <td mat-cell *matCellDef="let user">
        <span class="role-badge" [class]="user.role.toLowerCase()">
          {{ user.role }}
        </span>
      </td>
    </ng-container>

    <!-- Status Column -->
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Status</th>
      <td mat-cell *matCellDef="let user">
        <span class="status-badge" [class]="user.status.toLowerCase()">
          <mat-icon>{{ getStatusIcon(user.status) }}</mat-icon>
          {{ user.status | lowercase }}
        </span>
      </td>
    </ng-container>

    <!-- Joined Column -->
    <ng-container matColumnDef="joined">
      <th mat-header-cell *matHeaderCellDef>Joined</th>
      <td mat-cell *matCellDef="let user">
        <span class="joined-date">{{ getTimeAgo(user.joinedAt) }}</span>
      </td>
    </ng-container>

    <!-- Actions Column -->
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let user">
        <button mat-icon-button [matMenuTriggerFor]="userMenu" matTooltip="Actions">
          <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #userMenu="matMenu">
          <button mat-menu-item (click)="onView(user)">
            <mat-icon>visibility</mat-icon>
            View Profile
          </button>
          @if (user.status === 'PENDING') {
            <button mat-menu-item (click)="onApprove(user)">
              <mat-icon>check_circle</mat-icon>
              Approve
            </button>
          }
          @if (user.status === 'ACTIVE') {
            <button mat-menu-item (click)="onSuspend(user)">
              <mat-icon>block</mat-icon>
              Suspend
            </button>
          }
          @if (user.status === 'SUSPENDED') {
            <button mat-menu-item (click)="onActivate(user)">
              <mat-icon>check</mat-icon>
              Activate
            </button>
          }
        </mat-menu>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>


